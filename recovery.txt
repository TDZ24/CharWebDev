const whatsappModel = require("../shared/whatsappModels");
const whatsappService = require("../services/whatsappService");

function Process(textUser, number) {
  textUser = textUser.toLowerCase();
  const models = [];

  const sendWhatsAppMessage = (model) => {
    models.push(model);
    whatsappService.SendMessageWhatsApp(model);
  };

  if (textUser.includes("hola") || textUser.includes("hello")) {
    sendWhatsAppMessage(whatsappModel.MessageText("¬°Hola! ¬øEn qu√© puedo ayudarte hoy?", number));
    sendWhatsAppMessage(whatsappModel.MessageList(number));
  } else if (
    textUser.includes("donde estan ubicados") ||
    textUser.includes("cual es la ubicaci√≥n") ||
    textUser.includes("donde estan ubicados?") ||
    textUser.includes("dame la ubicados?")
  ) {
    sendWhatsAppMessage(whatsappModel.MessageText("üö© Claro que s√≠ estamos ubicados en la siguiente direcci√≥n: üö©", number));
    sendWhatsAppMessage(whatsappModel.MessageLocation(number));
  } else if (textUser.includes("gracias") || textUser.includes("thanks")) {
    sendWhatsAppMessage(whatsappModel.MessageText("Gracias a ti por existir TQM ü§©ü§©", number));
  } else if (textUser.includes("adios") || textUser.includes("bye")) {
    sendWhatsAppMessage(whatsappModel.MessageText("Hasta luego my love", number));
  } else if (textUser.includes("nevera")) {
    sendWhatsAppMessage(whatsappModel.MessageImageOne(number));
    sendWhatsAppMessage(whatsappModel.MessageBuyNevera(number));
  } else if (textUser.includes("licuadora")) {
    sendWhatsAppMessage(whatsappModel.MessageImageTwo(number));
    sendWhatsAppMessage(whatsappModel.MessageBuyLicuadora(number));
  } else if (textUser.includes("lavadora")) {
    sendWhatsAppMessage(whatsappModel.MessageImageThree(number));
    sendWhatsAppMessage(whatsappModel.MessageBuyLavadora(number));
  } else if (textUser.includes("comprar")) {
    sendWhatsAppMessage(whatsappModel.MessageImageQR(number));
    sendWhatsAppMessage(whatsappModel.MessageText("Con este c√≥digo QR puedes comprar este producto", number));
  } else if (textUser.includes("agencia")) {
    sendWhatsAppMessage(whatsappModel.MessageText("üö© Esta es la ubicaci√≥n de nuestra agencia: üö©", number));
    sendWhatsAppMessage(whatsappModel.MessageLocation(number));
  } else if (textUser.includes("mostrar listado")) {
    sendWhatsAppMessage(whatsappModel.MessageList(number));
  } else if (textUser.includes("contacto")) {
    sendWhatsAppMessage(whatsappModel.MessageText("*Centro de contacto:* \n +57 3006886607", number));
  } else if (textUser.includes("¬øcual es su horario de atencion?")) {
    sendWhatsAppMessage(
      whatsappModel.MessageText("*Este es el horario de atenci√≥n:* \n Lunes: 9:00 AM - 5:00 PM \n Martes: 9:00 AM - 5:00 PM \n Miercoles: 9:00 AM - 5:00 PM \n Jueves: 9:00 AM - 5:00 PM \n Viernes: 9:00 AM - 5:00 PM \n Sabado: 10:00 AM - 2:00 PM \n Domingo; Cerrado", number)
    );
  } else if (textUser.includes("¬øcu√°les son sus pr√≥ximos eventos?")) {
    sendWhatsAppMessage(
      whatsappModel.MessageWithEvents("*Pr√≥ximos Eventos:* \n Evento 1 - 10 de octubre a las 3:00 PM \n Evento 2 - 15 de octubre a las 6:30 PM \n Evento 3 - 22 de octubre a las 4:45 PM", number)
    );
  } else if (textUser.includes("recomi√©ndame electrodom√©sticos")) {
    const electrodomesticos = [
      "1. Refrigerador de doble puerta con dispensador de agua",
      "2. Lavadora de carga frontal con tecnolog√≠a de ahorro de energ√≠a",
      "3. Horno de convecci√≥n multifuncional",
      "4. Cafetera programable con molinillo integrado",
      "5. Aspiradora robot inteligente con mapeo",
    ];
    sendWhatsAppMessage(whatsappModel.MessageWithProducts(electrodomesticos, number));
  } else if (textUser.includes("reservar fecha")) {
    sendWhatsAppMessage(whatsappModel.MessageText("Por favor, ingresa la fecha y detalles de la reserva en formato DD/MM/AAAA HH:MM - Detalles adicionales", number));
    // Suponemos que la respuesta del usuario tiene el formato correcto: DD/MM/AAAA HH:MM - Detalles adicionales
    const userResponse = ""; // Esto es solo un ejemplo, debes ajustarlo seg√∫n tus necesidades
    const [userDate, userDetails] = userResponse.split(" - ");
    const reservationDetails = {
      date: userDate,
      details: userDetails,
    };
    sendWhatsAppMessage(whatsappModel.MessageWithReservation("¬°Fecha reservada con √©xito!", number, reservationDetails));
  } else if (textUser.includes("suscribirme al boletin") || textUser.includes("suscribirme")) {
    sendWhatsAppMessage(
      whatsappModel.MessageText("ü§© Woooooo quieres suscribirte a nuestro boletin muchas graciasü§© \n Solo dame tu correo para poder a√±adirte a la lista \n Mira aca hay una vista previa de como te va a llegar a tu correo: ", number)
    );
    sendWhatsAppMessage(whatsappModel.MessageText("Este es nuestro boletin: ", number));
    sendWhatsAppMessage(whatsappModel.MessageSubscriptionConfirmation(number));
  } else if (textUser.includes("@")) {
    sendWhatsAppMessage(whatsappModel.MessageText("Ya estar√≠as suscrito, te va a llegar un mensaje de confirmaci√≥n a tu correo electr√≥nico", number));
  } else if (textUser.includes("calificar") || textUser.includes("quiero calificar")) {
    sendWhatsAppMessage(
      whatsappModel.MessageText("ü§©Muchas gracias por calificar nuestro servicio, calif√≠canos del (1-5)ü§© \n 1 ‚≠ê \n  2 ‚≠ê‚≠ê  \n 3 ‚≠ê‚≠ê‚≠ê \n 4 ‚≠ê‚≠ê‚≠ê‚≠ê \n 5 ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê", number)
    );
  } else if (textUser.includes("1") || textUser.includes("2") || textUser.includes("3") || textUser.includes("4") || textUser.includes("5")) {
    sendWhatsAppMessage(whatsappModel.MessageText("Muchas gracias por calificarnos, si tienes alg√∫n problema o comentario puedes comunicarte con nosotros", number));
    sendWhatsAppMessage(whatsappModel.MessageText("*Centro de contacto:* \n +57 3006886607", number));
  } else if (textUser.includes("cuales son sus redes sociales") || textUser.includes("redes sociales")) {
    sendWhatsAppMessage(whatsappModel.MessageLink(number));
  } else {
    sendWhatsAppMessage(whatsappModel.MessageText("No te entiendo por DIOS D: ", number));
  }
  
  // No necesitas el bucle forEach ya que los mensajes se env√≠an dentro de la funci√≥n sendWhatsAppMessage.
  }
  
  module.exports = {
    Process,
  };